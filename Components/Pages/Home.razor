@page "/"
@using H5ServerSide_ToDoList.Codes.Services
@using H5ServerSide_ToDoList.Data.Models.Entities
@using Microsoft.AspNetCore.Authorization
@inject ICPRService _cprService
@* @attribute [Authorize(Policy ="AuthenticateUser")] *@
<PageTitle>Home</PageTitle>

<AuthorizeView>
    <Authorized>
        <h1>Hello, world!</h1>

        Welcome to your new app.
        <hr />

        <h2>Add CPR number to account.</h2>
        <hr />
            
        <div class="form-floating mb-3">
            <InputText @bind-Value="cprNumber" class="form-control" autocomplete="CPR" aria-required="true" placeholder="010100-1005" />
            <label for="CPR">CPR</label>
        </div>
        <button type="submit" @onclick="SubmitCPR" class="w-100 btn btn-lg btn-primary">Submit</button>
        
  
    </Authorized>
    <NotAuthorized>
        <div>Ikke logget ind.</div>
    </NotAuthorized>
</AuthorizeView>

@code {
    private string cprNumber = string.Empty;

    [SupplyParameterFromQuery]
    private string? ReturnUrl { get; set; }

    private async Task SubmitCPR()
    {
        await _cprService.AddCPRToUser(cprNumber);
    }

}


